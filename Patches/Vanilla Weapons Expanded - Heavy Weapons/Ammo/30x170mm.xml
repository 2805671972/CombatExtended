<?xml version="1.0" encoding="utf-8" ?>
<Patch>

  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Vanilla Weapons Expanded - Heavy Weapons</li>
    </mods>
    <match Class="PatchOperationAdd">
      <xpath>Defs</xpath>
      <value>

        <ThingCategoryDef>
          <defName>Ammo30x170mm</defName>
          <label>30x170mm</label>
          <parent>AmmoHighCaliber</parent>
          <iconPath>UI/Icons/ThingCategories/CaliberHighCaliber</iconPath>
        </ThingCategoryDef>

        <!-- === AmmoSet === -->

        <CombatExtended.AmmoSetDef>
          <defName>AmmoSet_30x170mm</defName>
          <label>30x170mm</label>
          <ammoTypes>
            <Ammo_30x170mm_AP>Bullet_30x170mm_AP</Ammo_30x170mm_AP>
            <Ammo_30x170mm_Incendiary>Bullet_30x170mm_Incendiary</Ammo_30x170mm_Incendiary>
          </ammoTypes>
        </CombatExtended.AmmoSetDef>

        <!-- === Ammo === -->

        <ThingDef Class="CombatExtended.AmmoDef" Name="Ammo30x170mmBase" ParentName="SmallAmmoBase" Abstract="True">
          <description>Large caliber cartridge used by the uranium slug rifle</description>
          <statBases>
            <Mass>0.807</Mass>
            <Bulk>1.10</Bulk>
          </statBases>
          <tradeTags>
            <li>CE_AutoEnableTrade</li>
            <li>CE_AutoEnableCrafting</li>
          </tradeTags>
          <thingCategories>
            <li>Ammo30x170mm</li>
          </thingCategories>
          <stackLimit>200</stackLimit>
        </ThingDef>

        <ThingDef Class="CombatExtended.AmmoDef" ParentName="Ammo30x170mmBase">
          <defName>Ammo_30x170mm_AP</defName>
          <label>30x170mm cartridge (AP)</label>
          <graphicData>
            <texPath>Things/Ammo/HighCaliber/Bofors/AP</texPath>
            <graphicClass>Graphic_StackCount</graphicClass>
          </graphicData>
          <statBases>
            <MarketValue>3.34</MarketValue>
          </statBases>
          <ammoClass>ArmorPiercing</ammoClass>
          <cookOffProjectile>Bullet_30x170mm_AP</cookOffProjectile>
        </ThingDef>

        <ThingDef Class="CombatExtended.AmmoDef" ParentName="Ammo30x170mmBase">
          <defName>Ammo_30x170mm_Incendiary</defName>
          <label>30x170mm cartridge (AP-I)</label>
          <graphicData>
            <texPath>Things/Ammo/HighCaliber/Bofors/HE</texPath>
            <graphicClass>Graphic_StackCount</graphicClass>
          </graphicData>
          <statBases>
            <MarketValue>4.54</MarketValue>
          </statBases>
          <ammoClass>IncendiaryAP</ammoClass>
          <cookOffProjectile>Bullet_30x170mm_Incendiary</cookOffProjectile>
        </ThingDef>

        <!-- === Projectile === -->
        <ThingDef Class="CombatExtended.AmmoDef" Name="Base30x170mmBullet" ParentName="BaseBullet" Abstract="true">
          <thingClass>CombatExtended.BulletCE</thingClass>
          <graphicData>
            <texPath>Things/Projectile/Bullet_Big</texPath>
            <graphicClass>Graphic_Single</graphicClass>
          </graphicData>
          <projectile Class="CombatExtended.ProjectilePropertiesCE">
            <damageDef>Bullet</damageDef>
            <speed>200</speed>
            <dropsCasings>true</dropsCasings>
          </projectile>
        </ThingDef>

        <ThingDef Class="CombatExtended.AmmoDef" ParentName="Base30x170mmBullet">
          <defName>Bullet_30x170mm_AP</defName>
          <label>30x170mm bullet (AP)</label>
          <projectile Class="CombatExtended.ProjectilePropertiesCE">
            <damageAmountBase>76</damageAmountBase>
            <armorPenetrationSharp>70</armorPenetrationSharp>
            <armorPenetrationBlunt>3449.480</armorPenetrationBlunt>
          </projectile>
        </ThingDef>

        <ThingDef Class="CombatExtended.AmmoDef" ParentName="Base30x170mmBullet">
          <defName>Bullet_30x170mm_Incendiary</defName>
          <label>30x170mm bullet (AP-I)</label>
          <projectile Class="CombatExtended.ProjectilePropertiesCE">
            <damageAmountBase>76</damageAmountBase>
            <armorPenetrationSharp>70</armorPenetrationSharp>
            <armorPenetrationBlunt>3449.480</armorPenetrationBlunt>
            <secondaryDamage>
              <li>
                <def>Flame_Secondary</def>
                <amount>50</amount>
              </li>
            </secondaryDamage>
          </projectile>
        </ThingDef>

        <!-- === Recipes === -->
        <RecipeDef ParentName="AdvancedAmmoRecipeBase">
          <defName>MakeAmmo_30x170mm_AP</defName>
          <label>make 30x170mm (AP) cartridge x200</label>
          <description>Craft 200 .30x170mm NATO (AP) cartridges.</description>
          <jobString>Making .30x170mm (AP) cartridges.</jobString>
          <ingredients>
            <li>
              <filter>
                <thingDefs>
                  <li>Steel</li>
                </thingDefs>
              </filter>
              <count>160</count>
            </li>
            <li>
              <filter>
                <thingDefs>
                  <li>Uranium</li>
                </thingDefs>
              </filter>
              <count>22</count>
            </li>
            <li>
              <filter>
                <thingDefs>
                  <li>Chemfuel</li>
                </thingDefs>
              </filter>
              <count>20</count>
            </li>
          </ingredients>
          <fixedIngredientFilter>
            <thingDefs>
              <li>Steel</li>
              <li>Uranium</li>
              <li>Chemfuel</li>
            </thingDefs>
          </fixedIngredientFilter>
          <products>
            <Ammo_30x170mm_AP>200</Ammo_30x170mm_AP>
          </products>
          <workAmount>16800</workAmount>
        </RecipeDef>

        <RecipeDef ParentName="AdvancedAmmoRecipeBase">
          <defName>MakeAmmo_30x170mm_Incendiary</defName>
          <label>make 30x170mm (AP-I) cartridge x200</label>
          <description>Craft 200 .30x170mm (AP-I) cartridges.</description>
          <jobString>Making .30x170mm (AP-I) cartridges.</jobString>
          <ingredients>
            <li>
              <filter>
                <thingDefs>
                  <li>Steel</li>
                </thingDefs>
              </filter>
              <count>160</count>
            </li>
            <li>
              <filter>
                <thingDefs>
                  <li>Uranium</li>
                </thingDefs>
              </filter>
              <count>22</count>
            </li>
            <li>
              <filter>
                <thingDefs>
                  <li>Prometheum</li>
                </thingDefs>
              </filter>
              <count>20</count>
            </li>
          </ingredients>
          <fixedIngredientFilter>
            <thingDefs>
              <li>Steel</li>
              <li>Uranium</li>
              <li>Prometheum</li>
            </thingDefs>
          </fixedIngredientFilter>
          <products>
            <Ammo_30x170mm_Incendiary>200</Ammo_30x170mm_Incendiary>
          </products>
          <workAmount>22400</workAmount>
        </RecipeDef>

      </value>
    </match>
  </Operation>

</Patch>