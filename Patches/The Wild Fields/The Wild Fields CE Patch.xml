<?xml version="1.0" encoding="utf-8"?>

<!-- 

	     WIP

	sabres rebalance : around CE Armory Sabre : DONE 

	todo : other weapon ( balance, mass, costs, prerequisites )



 -->


<Patch>
	<Operation Class = "PatchOperationFindMod">
		<mods>
			<li>The Wild Fields - apparel and weapons</li>
		</mods>
		<match Class = "PatchOperationSequence">
			<operations>

				<!-- Warscythe - Mix of Spear / Axe. Pretty cheap. Balanced around Vanilla Spear and MO Bardiche 
					WIP	-->

				<li Class = "PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_WarScythe"]/statBases</xpath>
					<value>
						<Bulk>10</Bulk>
						<MeleeCounterParryBonus>1.26</MeleeCounterParryBonus>
					</value>
				</li>
				<li Class = "PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_WarScythe"]/equippedStatOffsets</xpath>
					<value>
						<MeleeCritChance>0.17</MeleeCritChance>
						<MeleeParryChance>1.18</MeleeParryChance>
						<MeleeDodgeChance>0.7</MeleeDodgeChance>
					</value>
				</li>

				<!-- Mass and cost for weapon template for balancing if needed 

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName=""]/costStuffCount</xpath>
					<value>
						<costStuffCount>40</costStuffCount>
					</value>
				</li>


				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName=""]/statBases/Mass</xpath>
					<value>
						<Mass>1</Mass>
					</value>
				</li>	-->


				<li Class = "PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_WarScythe"]/tools</xpath>
					<value>
						<tools>							
							<li Class = "CombatExtended.ToolCE">
								<label>shaft</label>
								<capacities>
									<li>Poke</li>
								</capacities>
								<power>3.2</power>
								<cooldownTime>1.5</cooldownTime>
								<chanceFactor>0.05</chanceFactor>
								<armorPenetrationBlunt>0.9</armorPenetrationBlunt>
								<linkedBodyPartsGroup>Shaft</linkedBodyPartsGroup>
							</li>
							<li Class = "CombatExtended.ToolCE">
								<label>point</label>
								<capacities>
									<li>Stab</li>
								</capacities>
								<power>12.5</power>
								<cooldownTime>2.1</cooldownTime>
								<chanceFactor>0.20</chanceFactor>
								<armorPenetrationBlunt>3.6</armorPenetrationBlunt>
								<armorPenetrationSharp>2.32</armorPenetrationSharp>
								<linkedBodyPartsGroup>Point</linkedBodyPartsGroup>
							</li>
							<li Class = "CombatExtended.ToolCE">
								<label>head</label>
								<capacities>
									<li>Blunt</li>
								</capacities>
								<power>12.5</power>
								<cooldownTime>2.60</cooldownTime>
								<chanceFactor>0.15</chanceFactor>
								<armorPenetrationBlunt>8.5</armorPenetrationBlunt>
								<armorPenetrationSharp>0.85</armorPenetrationSharp>
								<linkedBodyPartsGroup>Head</linkedBodyPartsGroup>
							</li>
							<li Class = "CombatExtended.ToolCE">
								<label>edge</label>
								<capacities>
									<li>Cut</li>
								</capacities>
								<power>30</power>
								<cooldownTime>2.60</cooldownTime>
								<chanceFactor>0.60</chanceFactor>
								<armorPenetrationBlunt>8.5</armorPenetrationBlunt>
								<armorPenetrationSharp>0.85</armorPenetrationSharp>
								<linkedBodyPartsGroup>Edge</linkedBodyPartsGroup>
							</li>
						</tools>
					</value>
				</li>


				<!-- Noble Sabre - Elite Stuff - CE armory sabre with buffs and better stats, tweak prÃ©requis -->


				<li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_NobleSabre"]</xpath>
					<value>
						<equippedStatOffsets>
							<MeleeCritChance>1.25</MeleeCritChance>
							<MeleeParryChance>0.75</MeleeParryChance>
							<MeleeDodgeChance>0.40</MeleeDodgeChance>
							<SocialImpact>0.2</SocialImpact>
						</equippedStatOffsets>
					</value>
				</li>
				<!-- Replace stats -->

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_NobleSabre"]/statBases</xpath>
					<value>
						<statBases>
							<WorkToMake>16000</WorkToMake>
							<Mass>1</Mass>
							<Bulk>6</Bulk>
							<MeleeCounterParryBonus>0.63</MeleeCounterParryBonus>							
						</statBases>
					</value>
				</li>

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_NobleSabre"]/tools</xpath>
					<value>
						<tools>
							<li Class = "CombatExtended.ToolCE">
								<label>handle</label>
								<capacities>
									<li>Poke</li>
								</capacities>
								<power>2</power>
								<cooldownTime>1.5</cooldownTime>
								<chanceFactor>0.1</chanceFactor>
								<armorPenetrationBlunt>0.5</armorPenetrationBlunt>
								<linkedBodyPartsGroup>Handle</linkedBodyPartsGroup>
							</li>
							<li Class="CombatExtended.ToolCE">
								<label>point</label>
								<capacities>
									<li>Stab</li>
								</capacities>
								<power>18</power>
								<cooldownTime>1.27</cooldownTime>
								<armorPenetrationBlunt>1.96</armorPenetrationBlunt>
								<armorPenetrationSharp>3.92</armorPenetrationSharp>
								<linkedBodyPartsGroup>Point</linkedBodyPartsGroup>
							</li>
							<li Class="CombatExtended.ToolCE">
								<label>head</label>
								<capacities>
									<li>Blunt</li>
								</capacities>
								<power>20</power>
								<cooldownTime>2.73</cooldownTime>
								<armorPenetrationBlunt>7.84</armorPenetrationBlunt>
								<linkedBodyPartsGroup>Head</linkedBodyPartsGroup>
							</li>
							<li Class = "CombatExtended.ToolCE">
								<label>edge</label>
								<capacities>
									<li>Cut</li>
								</capacities>
								<power>29</power>
								<cooldownTime>2.37</cooldownTime>
								<chanceFactor>0.60</chanceFactor>
								<armorPenetrationBlunt>3.24</armorPenetrationBlunt>
								<armorPenetrationSharp>0.72</armorPenetrationSharp>
								<linkedBodyPartsGroup>Edge</linkedBodyPartsGroup>
							</li>
						</tools>
					</value>
				</li>

				<!-- Sabre, same as Noble but weaker, CE Armory Sabre clone,    -->


				<!-- <li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_Sabre"]/statBases</xpath>
					<value>
						<Bulk>6</Bulk>
						<MeleeCounterParryBonus>0.45</MeleeCounterParryBonus>
					</value>
				</li>  -->
				<li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_Sabre"]</xpath>
					<value>
						<equippedStatOffsets>
							<MeleeCritChance>1</MeleeCritChance>
							<MeleeParryChance>0.65</MeleeParryChance>
							<MeleeDodgeChance>0.35</MeleeDodgeChance>
						</equippedStatOffsets>
					</value>
				</li>

				<!-- Replace stats -->

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_Sabre"]/statBases</xpath>
					<value>
						<statBases>
							<WorkToMake>9000</WorkToMake>
							<Mass>1</Mass>
							<Bulk>6</Bulk>
							<MeleeCounterParryBonus>0.45</MeleeCounterParryBonus>							
						</statBases>
					</value>
				</li>

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_Sabre"]/recipeMaker</xpath>
					<value>
						<recipeMaker>
							<researchPrerequisite>Smithing</researchPrerequisite>
							<skillRequirements>
								<Crafting>5</Crafting>
							</skillRequirements>

						</recipeMaker>
					</value>
				</li>		

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_Sabre"]/tools</xpath>
					<value>
						<tools>
							<li Class = "CombatExtended.ToolCE">
								<label>handle</label>
								<capacities>
									<li>Poke</li>
								</capacities>
								<power>2</power>
								<cooldownTime>1.5</cooldownTime>
								<chanceFactor>0.1</chanceFactor>
								<armorPenetrationBlunt>0.5</armorPenetrationBlunt>
								<linkedBodyPartsGroup>Handle</linkedBodyPartsGroup>
							</li>
							<li Class="CombatExtended.ToolCE">
								<label>point</label>
								<capacities>
									<li>Stab</li>
								</capacities>
								<power>18</power>
								<cooldownTime>1.27</cooldownTime>
								<armorPenetrationBlunt>1.96</armorPenetrationBlunt>
								<armorPenetrationSharp>3.92</armorPenetrationSharp>
								<linkedBodyPartsGroup>Point</linkedBodyPartsGroup>
							</li>
							<li Class="CombatExtended.ToolCE">
								<label>head</label>
								<capacities>
									<li>Blunt</li>
								</capacities>
								<power>20</power>
								<cooldownTime>2.73</cooldownTime>
								<armorPenetrationBlunt>7.84</armorPenetrationBlunt>
								<linkedBodyPartsGroup>Head</linkedBodyPartsGroup>
							</li>
							<li Class = "CombatExtended.ToolCE">
								<label>edge</label>
								<capacities>
									<li>Cut</li>
								</capacities>
								<power>29</power>
								<cooldownTime>2.37</cooldownTime>
								<chanceFactor>0.60</chanceFactor>
								<armorPenetrationBlunt>3.24</armorPenetrationBlunt>
								<armorPenetrationSharp>0.72</armorPenetrationSharp>
								<linkedBodyPartsGroup>Edge</linkedBodyPartsGroup>
							</li>
						</tools>
					</value>
				</li>

				<!-- Weapon tags for ordinary sabre -->

				<li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_Sabre"]/weaponTags</xpath>
					<value>
						<li>CE_OneHandedWeapon</li>
					</value>
				</li>

				<!-- Bulava - high pen one handed mace
				add weapon tags WIP -->

				<li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_Bulava"]/statBases</xpath>
					<value>
						<Bulk>5</Bulk>
						<MeleeCounterParryBonus>0.24</MeleeCounterParryBonus>
					</value>
				</li>
				<li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_Bulava"]</xpath>
					<value>
						<equippedStatOffsets>
							<MeleeCritChance>0.42</MeleeCritChance>
							<MeleeParryChance>0.24</MeleeParryChance>
							<MeleeDodgeChance>0.2</MeleeDodgeChance>
							<SocialImpact>0.15</SocialImpact>
							<PainShockThreshold>0.12</PainShockThreshold>
						</equippedStatOffsets>
					</value>
				</li>
				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_Bulava"]/tools</xpath>
					<value>
						<tools>
							<li Class = "CombatExtended.ToolCE">
								<label>handle</label>
								<capacities>
									<li>Poke</li>
								</capacities>
								<power>3</power>
								<cooldownTime>1.59</cooldownTime>
								<chanceFactor>0.10</chanceFactor>
								<armorPenetrationBlunt>0.625</armorPenetrationBlunt>
								<linkedBodyPartsGroup>Handle</linkedBodyPartsGroup>
							</li>
							<li Class = "CombatExtended.ToolCE">
								<label>head</label>
								<capacities>
									<li>Blunt</li>
								</capacities>
								<power>18.50</power>
								<cooldownTime>2.1</cooldownTime>
								<chanceFactor>0.90</chanceFactor>
								<armorPenetrationBlunt>7.625</armorPenetrationBlunt>
								<linkedBodyPartsGroup>Head</linkedBodyPartsGroup>
							</li>
						</tools>
					</value>
				</li>
				<li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_MeleeWeapon_Bulava"]/weaponTags</xpath>
					<value>
						<li>CE_OneHandedWeapon</li>
					</value>
				</li>


				<!--Apparels-->

				<!-- Fur Vest - balancing MO leather tunic -->


				<li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_CommonerVest"]/statBases</xpath>
					<value>
						<Bulk>8.5</Bulk>
						<WornBulk>2.8</WornBulk>
					</value>
				</li>

						<!-- mass stuff -->

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_CommonerVest"]/statBases/Mass</xpath>
					<value>
						<Mass>2</Mass>
					</value>
				</li>

						<!-- cost stuffs -->

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_CommonerVest"]/costStuffCount</xpath>
					<value>
						<costStuffCount>50</costStuffCount>
					</value>
				</li>



				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_CommonerVest"]/statBases/StuffEffectMultiplierArmor</xpath>
					<value>
						<StuffEffectMultiplierArmor>5</StuffEffectMultiplierArmor>
					</value>
				</li>

				<!-- Noble cape - Warm, thick and luxurious cape -->

				<li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_NobleCape"]/statBases</xpath>
					<value>
						<Bulk>4</Bulk>
						<WornBulk>1</WornBulk>
					</value>
				</li>

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_NobleCape"]/statBases/Mass</xpath>
					<value>
						<Mass>1.8</Mass>
					</value>
				</li>

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_NobleCape"]/statBases/StuffEffectMultiplierArmor</xpath>
					<value>
						<StuffEffectMultiplierArmor>4</StuffEffectMultiplierArmor>
					</value>
				</li>
				
				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_NobleCape"]/costStuffCount</xpath>
					<value>
						<costStuffCount>90</costStuffCount>
					</value>
				</li>

				<!-- Noble shirt & Vyshyvanka - noble shirts -->

				<li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_NobleShirt" or defName="Serek_Apparel_Vyshyvanka"]/statBases</xpath>
					<value>
						<Bulk>1</Bulk>
						<WornBulk>0.5</WornBulk>
					</value>
				</li>

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_NobleShirt" or defName="Serek_Apparel_Vyshyvanka"]/statBases/Mass</xpath>
					<value>
						<Mass>1</Mass>
					</value>
				</li>				

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_NobleShirt or defName="Serek_Apparel_Vyshyvanka"]/statBases/StuffEffectMultiplierArmor</xpath>
					<value>
						<StuffEffectMultiplierArmor>1.1</StuffEffectMultiplierArmor>
					</value>
				</li>


				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_NobleShirt"]/costStuffCount</xpath>
					<value>
						<costStuffCount>40</costStuffCount>
					</value>
				</li>

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_Vyshyvanka"]/costStuffCount</xpath>
					<value>
						<costStuffCount>25</costStuffCount>
					</value>
				</li>

				<!--- Hats -->

				<li Class="PatchOperationAdd">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_Birka" or defName="Serek_Apparel_NobleFurCap" or defName="Serek_Apparel_NobleCap"
					]/statBases</xpath>
					<value>
						<Bulk>2</Bulk>
						<WornBulk>1</WornBulk>
					</value>
				</li>

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_Birka" or defName="Serek_Apparel_NobleFurCap" or defName="Serek_Apparel_NobleCap"]/statBases/StuffEffectMultiplierArmor</xpath>
					<value>
						<StuffEffectMultiplierArmor>3</StuffEffectMultiplierArmor>
					</value>
				</li>

				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_Birka"]/costStuffCount</xpath>
					<value>
						<costStuffCount>30</costStuffCount>
					</value>
				</li>
				<li Class="PatchOperationReplace">
					<xpath>Defs/ThingDef[defName="Serek_Apparel_NobleFurCap" or defName="Serek_Apparel_NobleCap"]/costStuffCount</xpath>
					<value>
						<costStuffCount>40</costStuffCount>
					</value>
				</li>
			</operations>
		</match>
	</Operation>
</Patch>